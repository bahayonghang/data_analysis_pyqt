# 数据分析应用 - 用户操作手册

## 📚 目录

1. [快速开始](#快速开始)
2. [界面介绍](#界面介绍)
3. [数据上传](#数据上传)
4. [数据分析](#数据分析)
5. [结果查看](#结果查看)
6. [历史记录](#历史记录)
7. [报告导出](#报告导出)
8. [设置配置](#设置配置)
9. [常见问题](#常见问题)
10. [故障排除](#故障排除)

---

## 🚀 快速开始

### 系统要求
- **操作系统**: Windows 10+, macOS 10.14+, Linux (Ubuntu 18.04+)
- **Python版本**: 3.11+
- **内存要求**: 最低4GB，推荐8GB以上
- **磁盘空间**: 最少500MB可用空间

### 安装步骤

1. **下载应用程序**
   ```bash
   # 方式1: 直接下载可执行文件
   # 从 https://github.com/your-repo/releases 下载最新版本
   
   # 方式2: 源码安装
   git clone https://github.com/your-repo/data_analysis_pyqt.git
   cd data_analysis_pyqt
   ```

2. **安装依赖**
   ```bash
   # 使用uv管理依赖（推荐）
   uv venv
   source .venv/bin/activate  # Windows: .venv\Scripts\activate
   uv pip install -r requirements.txt
   ```

3. **启动应用**
   ```bash
   # 方式1: 使用uv运行
   uv run python main.py
   
   # 方式2: 直接运行
   python main.py
   ```

### 首次使用
1. 启动应用后，您将看到欢迎界面
2. 点击"数据上传"开始您的第一次分析
3. 选择支持的数据文件（CSV、Excel、Parquet）
4. 等待数据加载和分析完成
5. 查看分析结果和可视化图表

---

## 🖥️ 界面介绍

### 主界面布局

```
┌─────────────────────────────────────────────────────────┐
│  数据分析应用                                      [─][□][×] │
├─────────────────────────────────────────────────────────┤
│ [数据上传] [数据分析] [历史记录] [设置]                         │
├─────────────────────────────────────────────────────────┤
│                                                         │
│                   主要内容区域                            │
│                                                         │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │  数据预览    │  │  分析结果    │  │  图表展示    │       │
│  │             │  │             │  │             │       │
│  └─────────────┘  └─────────────┘  └─────────────┘       │
│                                                         │
├─────────────────────────────────────────────────────────┤
│ 状态栏: 就绪 │ 进度: ████████████ 100% │ 内存: 45MB      │
└─────────────────────────────────────────────────────────┘
```

### 导航栏功能
- **数据上传**: 上传和预览数据文件
- **数据分析**: 配置分析参数，查看分析结果
- **历史记录**: 管理历史分析记录
- **设置**: 应用程序配置和个性化设置

### 状态栏信息
- **状态指示**: 显示当前操作状态
- **进度条**: 显示数据处理进度
- **系统信息**: 内存使用、处理时间等

---

## 📁 数据上传

### 支持的文件格式

| 格式 | 扩展名 | 说明 | 最大文件大小 |
|------|--------|------|-------------|
| CSV | .csv | 逗号分隔值文件 | 500MB |
| Excel | .xlsx, .xls | Microsoft Excel文件 | 100MB |
| Parquet | .parquet | 高效列式存储格式 | 1GB |

### 上传步骤

1. **选择文件**
   - 点击"数据上传"标签页
   - 点击"选择文件"按钮或拖拽文件到上传区域
   - 选择您要分析的数据文件

2. **文件验证**
   - 系统自动检查文件格式和完整性
   - 显示文件基本信息：大小、行数、列数
   - 检查数据质量和时间列

3. **数据预览**
   - 查看前10行数据样本
   - 确认列名和数据类型
   - 检查是否有缺失值或异常数据

### 数据质量要求

✅ **推荐的数据格式**:
- 第一行为列标题
- 数值列使用数字格式
- 日期时间列使用标准格式 (YYYY-MM-DD HH:mm:ss)
- 避免特殊字符和空格在列名中

⚠️ **常见问题**:
- 编码问题：建议使用UTF-8编码
- 大小写敏感：列名大小写会影响分析
- 缺失值：空值过多可能影响分析质量

---

## 📊 数据分析

### 分析类型

#### 1. 描述性统计分析
- **均值、中位数、众数**: 数据集中趋势
- **标准差、方差**: 数据离散程度
- **最值、分位数**: 数据分布范围
- **偏度、峰度**: 数据分布形状

#### 2. 相关性分析
- **Pearson相关**: 线性相关关系
- **Spearman相关**: 单调相关关系
- **相关矩阵**: 变量间关系可视化
- **显著性检验**: 相关性统计显著性

#### 3. 异常值检测
- **Z-score方法**: 基于标准差的异常检测
- **IQR方法**: 基于四分位距的异常检测
- **异常值标记**: 自动标识和高亮异常数据
- **处理建议**: 提供异常值处理方案

#### 4. 时间序列分析
- **趋势分析**: 数据长期变化趋势
- **季节性分析**: 周期性模式识别
- **平稳性检验**: ADF检验、KPSS检验
- **自相关分析**: 时间序列内部相关性

### 分析配置

#### 基本设置
```
┌─────────────────────────────────────┐
│ 分析配置                            │
├─────────────────────────────────────┤
│ ☑ 描述性统计                        │
│ ☑ 相关性分析                        │
│ ☑ 异常值检测                        │
│ ☐ 时间序列分析                      │
├─────────────────────────────────────┤
│ 异常值检测方法: [Z-score ▼]         │
│ 异常值阈值: [3.0    ]               │
│ 相关性方法: [Pearson ▼]             │
├─────────────────────────────────────┤
│        [开始分析]                   │
└─────────────────────────────────────┘
```

#### 高级选项
- **缺失值处理**: 删除、填充、插值
- **数据标准化**: Z-score、Min-Max标准化
- **采样设置**: 大数据集采样分析
- **并行处理**: 多核并行计算加速

---

## 📈 结果查看

### 统计结果表格

分析完成后，您可以查看详细的统计结果：

#### 描述性统计
```
┌─────────────┬─────────┬─────────┬─────────┬─────────┐
│ 变量名       │ 均值    │ 标准差   │ 最小值   │ 最大值   │
├─────────────┼─────────┼─────────┼─────────┼─────────┤
│ temperature │ 25.3    │ 4.8     │ 12.1    │ 38.9    │
│ humidity    │ 65.2    │ 12.3    │ 35.4    │ 95.7    │
│ pressure    │ 1013.2  │ 18.9    │ 980.3   │ 1045.8  │
└─────────────┴─────────┴─────────┴─────────┴─────────┘
```

#### 相关性矩阵
热力图显示变量间的相关关系，颜色深浅表示相关强度。

### 可视化图表

#### 1. 分布图
- **直方图**: 显示数据分布形状
- **箱线图**: 显示四分位数和异常值
- **小提琴图**: 结合密度和分布信息

#### 2. 关系图
- **散点图**: 显示两变量关系
- **相关热力图**: 变量间相关性可视化
- **配对图**: 多变量关系矩阵

#### 3. 时间序列图
- **趋势图**: 时间序列变化趋势
- **季节性分解**: 趋势、季节、残差分离
- **自相关图**: ACF、PACF分析

### 交互功能
- **图表缩放**: 滚轮缩放、拖拽平移
- **数据标注**: 点击查看详细数值
- **图例控制**: 显示/隐藏数据系列
- **导出图片**: PNG、SVG、PDF格式

---

## 📚 历史记录

### 记录管理

#### 查看历史
```
┌─────────────────────────────────────────────────────────┐
│ 分析历史记录                                              │
├─────────────────────────────────────────────────────────┤
│ 搜索: [关键词搜索________________] [🔍] [筛选▼]          │
├─────────────────────────────────────────────────────────┤
│ 日期       │ 文件名      │ 状态    │ 大小   │ 操作        │
├───────────┼───────────┼────────┼───────┼─────────────┤
│ 2024-01-15│ sales.csv  │ ✅完成   │ 2.3MB │ [查看][删除] │
│ 2024-01-14│ data.xlsx  │ ✅完成   │ 1.8MB │ [查看][删除] │
│ 2024-01-13│ log.csv    │ ❌失败   │ 5.1MB │ [重试][删除] │
└───────────┴───────────┴────────┴───────┴─────────────┘
```

#### 记录详情
- **文件信息**: 名称、大小、上传时间
- **分析配置**: 使用的分析参数和方法
- **结果摘要**: 关键统计指标和发现
- **处理日志**: 分析过程和错误信息

### 批量操作
- **批量删除**: 选择多条记录删除
- **批量导出**: 导出多个分析结果
- **数据备份**: 导出历史记录到文件
- **记录恢复**: 从备份文件恢复记录

---

## 📋 报告导出

### 导出格式

#### 1. PDF报告
- **完整报告**: 包含所有分析结果和图表
- **执行摘要**: 关键发现和建议
- **技术附录**: 详细统计数据和方法说明
- **自定义模板**: 支持企业品牌定制

#### 2. 数据文件
- **CSV格式**: 处理后的数据和结果
- **Excel格式**: 多工作表结构化输出
- **JSON格式**: 结构化数据交换格式
- **Parquet格式**: 高效的列式存储

#### 3. 图表文件
- **PNG格式**: 高质量位图图像
- **SVG格式**: 矢量图形，可缩放
- **PDF格式**: 印刷质量图表
- **HTML格式**: 交互式网页图表

### 导出配置

```
┌─────────────────────────────────────┐
│ 导出设置                            │
├─────────────────────────────────────┤
│ 报告类型:                           │
│ ☑ 完整PDF报告                       │
│ ☑ 数据文件 (CSV)                    │
│ ☑ 图表集合 (PNG)                    │
│ ☐ 技术报告 (详细)                   │
├─────────────────────────────────────┤
│ 图表设置:                           │
│ 分辨率: [300 DPI]                   │
│ 尺寸: [10x6 英寸]                   │
│ 格式: [PNG ▼]                       │
├─────────────────────────────────────┤
│ 输出位置:                           │
│ [/Users/docs/reports/] [浏览...]     │
├─────────────────────────────────────┤
│            [开始导出]               │
└─────────────────────────────────────┘
```

---

## ⚙️ 设置配置

### 应用设置

#### 界面设置
- **主题选择**: 浅色主题、深色主题、自动
- **语言选择**: 中文、英文
- **字体大小**: 小、中、大、超大
- **界面缩放**: 100%、125%、150%

#### 性能设置
- **内存限制**: 设置最大内存使用量
- **并行线程**: CPU核心数利用设置
- **缓存大小**: 临时文件缓存限制
- **数据采样**: 大文件自动采样阈值

#### 数据设置
- **默认编码**: UTF-8、GBK、ASCII
- **时间格式**: 日期时间解析格式
- **数值精度**: 小数位数显示设置
- **缺失值标识**: 空值表示方法

### 高级配置

#### 分析参数
```json
{
  "outlier_detection": {
    "default_method": "zscore",
    "zscore_threshold": 3.0,
    "iqr_factor": 1.5
  },
  "correlation": {
    "default_method": "pearson",
    "significance_level": 0.05
  },
  "time_series": {
    "stationarity_test": "adf",
    "seasonal_decompose": true
  }
}
```

#### 导出设置
```json
{
  "pdf_report": {
    "page_size": "A4",
    "include_toc": true,
    "include_summary": true
  },
  "charts": {
    "default_dpi": 300,
    "default_format": "png",
    "color_palette": "viridis"
  }
}
```

---

## ❓ 常见问题

### 文件上传问题

**Q: 支持哪些文件格式？**
A: 支持CSV (.csv)、Excel (.xlsx, .xls)、Parquet (.parquet) 格式。

**Q: 文件大小有限制吗？**
A: CSV文件最大500MB，Excel文件最大100MB，Parquet文件最大1GB。

**Q: 上传时出现编码错误怎么办？**
A: 
1. 确保文件使用UTF-8编码保存
2. 在上传时手动选择正确的编码格式
3. 使用文本编辑器转换文件编码

### 数据分析问题

**Q: 为什么分析结果显示异常？**
A: 可能的原因：
1. 数据质量问题：检查是否有过多缺失值
2. 数据类型错误：确认数值列为数字格式
3. 异常值干扰：考虑预处理异常值

**Q: 时间序列分析无法进行？**
A: 确认数据包含有效的时间列：
1. 时间列格式正确 (YYYY-MM-DD HH:mm:ss)
2. 时间数据连续且有序
3. 数据量足够进行时间序列分析

**Q: 相关性分析结果为空？**
A: 检查以下条件：
1. 数据集包含至少2个数值列
2. 数值列有足够的变异性
3. 没有常数列或缺失值过多的列

### 性能问题

**Q: 处理大文件时程序卡顿？**
A: 优化建议：
1. 关闭其他不必要的程序释放内存
2. 在设置中启用数据采样
3. 分批处理大数据集
4. 升级硬件配置（内存、CPU）

**Q: 分析速度很慢怎么办？**
A: 性能优化：
1. 检查并行处理设置
2. 清理系统临时文件
3. 重启应用程序释放内存
4. 使用Parquet格式提高I/O效率

---

## 🔧 故障排除

### 启动问题

#### 应用无法启动
1. **检查Python环境**
   ```bash
   python --version  # 确认Python 3.11+
   which python      # 确认Python路径
   ```

2. **检查依赖安装**
   ```bash
   pip list | grep -E "(pandas|numpy|matplotlib|PyQt6)"
   ```

3. **检查系统资源**
   - 可用内存 > 2GB
   - 磁盘空间 > 500MB
   - 没有防火墙阻止

#### 依赖错误
```bash
# 重新安装依赖
pip uninstall -r requirements.txt -y
pip install -r requirements.txt

# 或使用uv
uv pip sync requirements.txt
```

### 运行时错误

#### 内存不足错误
- **症状**: "MemoryError" 或程序崩溃
- **解决方案**:
  1. 减小数据集大小或启用采样
  2. 关闭其他内存密集型程序
  3. 增加系统虚拟内存
  4. 升级物理内存

#### 文件权限错误
- **症状**: "PermissionError" 或无法写入文件
- **解决方案**:
  1. 以管理员权限运行应用
  2. 检查输出目录的写入权限
  3. 选择其他输出位置

#### 数据格式错误
- **症状**: "ValueError" 或解析失败
- **解决方案**:
  1. 检查文件格式和编码
  2. 验证数据完整性
  3. 使用数据预处理工具清理数据

### 界面问题

#### 界面显示异常
- **症状**: 窗口布局错乱、按钮无响应
- **解决方案**:
  1. 重启应用程序
  2. 重置界面设置到默认值
  3. 检查系统显示缩放设置
  4. 更新显卡驱动程序

#### 图表显示问题
- **症状**: 图表无法显示或格式错误
- **解决方案**:
  1. 检查matplotlib后端设置
  2. 更新图形库依赖
  3. 重新生成图表
  4. 尝试不同的图表格式

### 数据问题

#### 中文乱码
- **解决方案**:
  1. 确保文件使用UTF-8编码
  2. 在上传时指定正确编码
  3. 安装中文字体支持

#### 数据精度丢失
- **解决方案**:
  1. 检查数据类型设置
  2. 增加数值精度配置
  3. 使用高精度数据格式

---

## 📞 技术支持

### 获取帮助
- **在线文档**: https://docs.example.com
- **问题反馈**: https://github.com/your-repo/issues
- **用户社区**: https://community.example.com
- **邮件支持**: support@example.com

### 系统信息收集
遇到问题时，请提供以下信息：
1. 操作系统版本
2. Python版本
3. 应用版本号
4. 错误信息截图
5. 问题重现步骤

### 日志文件位置
- **Windows**: `%APPDATA%/DataAnalysisApp/logs/`
- **macOS**: `~/Library/Logs/DataAnalysisApp/`
- **Linux**: `~/.local/share/DataAnalysisApp/logs/`

---

## 📝 更新日志

### 版本历史
- **v1.0.0** (2024-01-15): 初始发布版本
- **v1.1.0** (2024-02-01): 增加时间序列分析
- **v1.2.0** (2024-02-15): 优化性能和内存使用
- **v1.3.0** (2024-03-01): 增加PDF报告导出

### 即将发布
- **v1.4.0**: 机器学习算法集成
- **v1.5.0**: 云端数据源支持
- **v2.0.0**: 全新界面设计

---

*最后更新: 2024-03-01*
*文档版本: v1.3.0*